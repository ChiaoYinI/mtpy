dist: xenial
sudo: required
language: python
python:
#- '2.7'
- '3.7'
before_script: null
install:
- wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh;
- bash miniconda.sh -b -p $HOME/miniconda
- export PATH="$HOME/miniconda/bin:$PATH"
- hash -r
- conda config --set always_yes yes --set changeps1 no
- conda update -q conda
- conda info -a
- conda create -q -n test-env python=$TRAVIS_PYTHON_VERSION pytest pytest-cov pyyaml
- source activate test-env
- conda install geopandas netcdf4
- pip install  obspy
- pip install pytest-xdist  pytest-cov coveralls
- pip install configparser
script:
- MTPY_TEST_COMPARE_IMAGE=False; py.test -v --cov=mtpy --cov-report= tests/core --ignore=tests/SmartMT

deploy:
  provider: pypi
  user: zhang01GA
  password:
    secure: ZhmYcS/QA24YFH3mMgcByFvJzFs6mEA4y4YvAh22yJ84w+P0x+Mp4SrYR3Ku6K8yKGTgj/GUY8H3AdsJAb0v/BbNaN595zua24lEL1PvZuHKo4ohfKzljG4NR/fDpHFdkNWJ3s67OWKmDFGGBN0VcDEBjq2jPkscTk7zdpxQ9iPgfE0tPS1rCCCCX/2T761a747KHQ1/lFfokT8yep1l0HbAjN7X3U3410OshVWGnOk7M1ZvMT83FUm1Y1NOiFBXgs5k7Nki29gyIDRy/x5BagBQz6w2OS8kaa4gkUjS+zbtbRH4zr8S2NV43xLkCdcXZl58tgTPZKnRrfuXbFhbHRZT/EDczmsj77f70+CQl2LU9RJLTjDt6P4HjAJJS22flHe66VbR6fErCHMA1EX36Jentu2PrHcHgK2NNHRpa2u8dNFA2dtmplONqsG0O8qIpn43p4Ct4aUYYQC6m+cXLYQU2etYadjL8HZVdImViinAK3AufaZrq7CjKSQ+E8R1AfbVBykSztzUvN8FKaBu4uW1+Bcn02rVB/cOhIVYlxt0Uhwc11NWlM1zqj4TRwGdR5qG1vdKtFPfBT+OySGio49AcSIQVxTUPj8p6bKPo6r6DJZ1rMuTb7CYggqEk9iN6+IquREORBiFuKljvrhTlGyWhz8tX2Y31Cn6qzPpR9o=
  on:
    branch: master

after_failure:
- cat config.log
after_success:
- coveralls
