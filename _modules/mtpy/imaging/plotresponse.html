
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>mtpy.imaging.plotresponse &#8212; mtpy 1.01.01 documentation</title>
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../master_doc.html">mtpy 1.01.01 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for mtpy.imaging.plotresponse</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">============</span>
<span class="sd">plotresponse</span>
<span class="sd">============</span>

<span class="sd">Plots the resistivity and phase for different modes and components</span>

<span class="sd">Created on Thu May 30 16:54:08 2013</span>

<span class="sd">@author: jpeacock-pr</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#==============================================================================</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="k">import</span> <span class="n">MultipleLocator</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">colors</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">patches</span>
<span class="kn">import</span> <span class="nn">matplotlib.colorbar</span> <span class="k">as</span> <span class="nn">mcb</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>
<span class="kn">import</span> <span class="nn">mtpy.imaging.mtcolors</span> <span class="k">as</span> <span class="nn">mtcl</span>
<span class="kn">import</span> <span class="nn">mtpy.imaging.mtplottools</span> <span class="k">as</span> <span class="nn">mtpl</span>

<span class="c1">#==============================================================================</span>


<span class="c1">#==============================================================================</span>
<span class="c1">#  Plot apparent resistivity and phase</span>
<span class="c1">#==============================================================================</span>
<div class="viewcode-block" id="PlotResponse"><a class="viewcode-back" href="../../../imaging.html#mtpy.imaging.plotresponse.PlotResponse">[docs]</a><span class="k">class</span> <span class="nc">PlotResponse</span><span class="p">(</span><span class="n">mtpl</span><span class="o">.</span><span class="n">PlotSettings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots Resistivity and phase for the different modes of the MT response.  At</span>
<span class="sd">    the moment is supports the input of an .edi file. Other formats that will</span>
<span class="sd">    be supported are the impedance tensor and errors with an array of periods</span>
<span class="sd">    and .j format.</span>
<span class="sd">    </span>
<span class="sd">    The normal use is to input an .edi file, however it would seem that not</span>
<span class="sd">    everyone uses this format, so you can input the data and put it into </span>
<span class="sd">    arrays or objects like class mtpy.core.z.Z.  Or if the data is in </span>
<span class="sd">    resistivity and phase format they can be input as arrays or a class</span>
<span class="sd">    mtpy.imaging.mtplot.ResPhase.  Or you can put it into a class</span>
<span class="sd">    mtpy.imaging.mtplot.MTplot.</span>
<span class="sd">    </span>
<span class="sd">    The plot places the apparent resistivity in log scale in the top panel(s), </span>
<span class="sd">    depending on the plot_num.  The phase is below this, note that 180 degrees</span>
<span class="sd">    has been added to the yx phase so the xy and yx phases plot in the same</span>
<span class="sd">    quadrant.  Both the resistivity and phase share the same x-axis which is in</span>
<span class="sd">    log period, short periods on the left to long periods on the right.  So</span>
<span class="sd">    if you zoom in on the plot both plots will zoom in to the same </span>
<span class="sd">    x-coordinates.  If there is tipper information, you can plot the tipper</span>
<span class="sd">    as a third panel at the bottom, and also shares the x-axis.  The arrows are</span>
<span class="sd">    in the convention of pointing towards a conductor.  The xx and yy </span>
<span class="sd">    components can be plotted as well, this adds two panels on the right.  </span>
<span class="sd">    Here the phase is left unwrapped.  Other parameters can be added as </span>
<span class="sd">    subplots such as strike, skew and phase tensor ellipses.</span>
<span class="sd">    </span>
<span class="sd">    To manipulate the plot you can change any of the attributes listed below</span>
<span class="sd">    and call redraw_plot().  If you know more aout matplotlib and want to </span>
<span class="sd">    change axes parameters, that can be done by changing the parameters in the</span>
<span class="sd">    axes attributes and then call update_plot(), note the plot must be open.</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    ----------</span>
<span class="sd">        **fn**: string</span>
<span class="sd">                       filename containing impedance (.edi) is the only </span>
<span class="sd">                       format supported at the moment</span>
<span class="sd">                       </span>
<span class="sd">        **z_array**: np.ndarray((nf, 2, 2), dtype=&#39;complex&#39;)</span>
<span class="sd">                impedance tensor with length of nf -&gt; the number of freq</span>
<span class="sd">                *default* is None</span>
<span class="sd">                </span>
<span class="sd">        **z_err_array**: np.ndarray((nf, 2, 2), dtype=&#39;real&#39;)</span>
<span class="sd">                    impedance tensor error estimates, same shape as z.</span>
<span class="sd">                    *default* is None</span>
<span class="sd">                    </span>
<span class="sd">        **res_array**: np.ndarray((nf, 2, 2))</span>
<span class="sd">                        array of resistivity values in linear scale.</span>
<span class="sd">                        *default* is None</span>
<span class="sd">                        </span>
<span class="sd">        **res_err_array**: np.ndarray((nf, 2, 2))</span>
<span class="sd">                            array of resistivity error estimates, same shape </span>
<span class="sd">                            as res_array. *default* is None</span>
<span class="sd">                            </span>
<span class="sd">        **phase_array**: np.ndarray((nf, 2, 2))</span>
<span class="sd">                          array of phase values in degrees, same shape as </span>
<span class="sd">                          res_array. *default* is None</span>
<span class="sd">                          </span>
<span class="sd">        **phase_err_array**: np.ndarray((nf, 2, 2))</span>
<span class="sd">                              array of phase error estimates, same shape as </span>
<span class="sd">                              phase_array. *default* is None</span>
<span class="sd">                              </span>
<span class="sd">        **tipper_array**: np.ndarray((nf, 1, 2), dtype=&#39;complex&#39;)</span>
<span class="sd">                           array of tipper values for tx, ty. *default* is None</span>
<span class="sd">                           </span>
<span class="sd">        **tipper_err_array**: np.ndarray((nf, 1, 2))</span>
<span class="sd">                               array of tipper error estimates, same shape as</span>
<span class="sd">                               tipper_array. *default* is None</span>
<span class="sd">                               </span>
<span class="sd">        **z_object**: class mtpy.core.z.Z</span>
<span class="sd">                      object of mtpy.core.z.  If this is input be sure the</span>
<span class="sd">                      attribute z.freq is filled.  *default* is None</span>
<span class="sd">                      </span>
<span class="sd">        **tipper_object**: class mtpy.core.z.Tipper</span>
<span class="sd">                            object of mtpy.core.z. If this is input be sure the</span>
<span class="sd">                            attribute z.freq is filled.  </span>
<span class="sd">                            *default* is None </span>
<span class="sd">                            </span>
<span class="sd">        **mt_object** : class mtpy.imaging.mtplottools.MTplot</span>
<span class="sd">                        object of mtpy.imaging.mtplottools.MTplot</span>
<span class="sd">                        *default* is None</span>
<span class="sd">                        </span>
<span class="sd">    Optional Key Words:</span>
<span class="sd">    --------------------</span>
<span class="sd">                  </span>
<span class="sd">        *fig_num*: int</span>
<span class="sd">                     figure number</span>
<span class="sd">                     *default* is 1</span>
<span class="sd">        </span>
<span class="sd">        *fig_size*: [width, height] in inches of actual figure size</span>
<span class="sd">                     </span>
<span class="sd">        *ffactor*: float</span>
<span class="sd">                      scaling factor for computing resistivity from </span>
<span class="sd">                      impedances.</span>
<span class="sd">                      *Default* is 1</span>
<span class="sd">        </span>
<span class="sd">        *rotation_angle*: float</span>
<span class="sd">                   rotation angle of impedance tensor (deg or radians), </span>
<span class="sd">                   *Note* : rotaion is clockwise positive</span>
<span class="sd">                   *default* is 0</span>
<span class="sd">        </span>
<span class="sd">        *plot_num*: [ 1 | 2 | 3 ]</span>
<span class="sd">                        * 1 for just Ex/By and Ey/Bx *default*</span>
<span class="sd">                        * 2 for all 4 components</span>
<span class="sd">                        * 3 for off diagonal plus the determinant</span>
<span class="sd">    </span>
<span class="sd">        *plot_title*: string</span>
<span class="sd">                         plot_title of plot</span>
<span class="sd">                         *default* is station name</span>
<span class="sd">                    </span>
<span class="sd">        *plot_tipper*: [ &#39;yri&#39; | &#39;yr&#39; | &#39;yi&#39; | &#39;n&#39; ]</span>
<span class="sd">                          Plots the tipper in a bottom pannel</span>
<span class="sd">                          * &#39;yri&#39;  --&gt; plots the real and imaginar parts</span>
<span class="sd">                          * &#39;yr&#39;   --&gt; plots just the real part</span>
<span class="sd">                          * &#39;yi&#39;   --&gt; plots just the imaginary part</span>
<span class="sd">                          </span>
<span class="sd">                          *Note:* the convention is to point towards a </span>
<span class="sd">                          conductor.  Can change this by setting the</span>
<span class="sd">                          parameter arrow_direction = 1.</span>
<span class="sd">                          </span>
<span class="sd">        *plot_strike*: [ &#39;y&#39; | 1 | 2 | 3 | &#39;n&#39; ]</span>
<span class="sd">                          Plots the strike angle from different parameters:</span>
<span class="sd">                              * &#39;y&#39;  --&gt; plots strike angle determined from </span>
<span class="sd">                                         the invariants of Weaver et al. [2000]</span>
<span class="sd">                                         and the phase tensor of</span>
<span class="sd">                                         Caldwell et al. [2004], if Tipper is </span>
<span class="sd">                                         plotted the strike of the tipper is</span>
<span class="sd">                                         also plotted.</span>
<span class="sd">                                         </span>
<span class="sd">                               * 1  --&gt; plots strike angle determined from </span>
<span class="sd">                                        the invariants of Weaver et al. [2000]</span>
<span class="sd">                               * 2  --&gt; plots strike angle determined from </span>
<span class="sd">                                        the phase tensor of </span>
<span class="sd">                                        Caldwell et al. [2004]</span>
<span class="sd">                               * 3  --&gt; plots strike angle determined from </span>
<span class="sd">                                        the tipper</span>
<span class="sd">                               * &#39;n&#39; --&gt; doesn&#39;t plot the strike, *default*</span>
<span class="sd">                               </span>
<span class="sd">        *plot_skew*: [ &#39;y&#39; | &#39;n&#39; ]</span>
<span class="sd">                        plots the skew angle calculated from the phase tensor</span>
<span class="sd">                            * &#39;y&#39; --&gt; plots skew angle</span>
<span class="sd">                            * &#39;n&#39; --&gt; does not plot skew angle *default*</span>
<span class="sd">                            </span>
<span class="sd">        *plot_pt*: [ &#39;y&#39; | &#39;n&#39; ]</span>
<span class="sd">                    plots the phase tensor ellipses which have the properties</span>
<span class="sd">                    of ellipse_</span>
<span class="sd">                        * &#39;y&#39; --&gt; plots phase tensor ellipses</span>
<span class="sd">                        * &#39;n&#39; --&gt; does not plot ellipses *default*</span>
<span class="sd">                          </span>
<span class="sd">        *fig_dpi*: int</span>
<span class="sd">                 dots-per-inch resolution, *default* is 300</span>
<span class="sd">                    </span>
<span class="sd">                        </span>
<span class="sd">        :Example: ::</span>
<span class="sd">            </span>
<span class="sd">            &gt;&gt;&gt; import mtpy.imaging.mtplot as mtplot</span>
<span class="sd">            &gt;&gt;&gt; edifile = r&quot;/home/MT01/MT01.edi&quot;</span>
<span class="sd">            &gt;&gt;&gt; rp1 = mtplot.PlotResPhase(fn=edifile, plot_num=2)</span>
<span class="sd">            &gt;&gt;&gt; # plots all 4 components</span>
<span class="sd">            &gt;&gt;&gt; rp1 = mtplot.PlotResPhase(fn=edifile, plot_tipper=&#39;yr&#39;)</span>
<span class="sd">            &gt;&gt;&gt; # plots the real part of the tipper</span>
<span class="sd">            </span>
<span class="sd">    Attributes:</span>
<span class="sd">    -----------</span>
<span class="sd">        -fn              filename to be plotted (only supports .edi so far) </span>
<span class="sd">        -fig_num         figure number for plotting</span>
<span class="sd">        -fig_size        size of figure in inches [width, height]</span>
<span class="sd">        -plot_num        plot type, see arguments for details </span>
<span class="sd">        -plot_title      title of the plot, *default* is station name</span>
<span class="sd">        -fig_dpi         Dots-per-inch resolution of plot, *default* is 300</span>
<span class="sd">        -rotation_angle           Rotate impedance tensor by this angle (deg) assuming</span>
<span class="sd">                         that North is 0 and angle is positive clockwise</span>
<span class="sd">                        </span>
<span class="sd">        -plot_tipper    string to tell the program to plot tipper arrows or </span>
<span class="sd">                        not, see accepted values above in arguments</span>
<span class="sd">        </span>
<span class="sd">        -plot_strike    string or integer telling the program to plot the </span>
<span class="sd">                        strike angle, see values above in arguments</span>
<span class="sd">                        </span>
<span class="sd">        -plot_skew      string to tell the program to plot skew angle.</span>
<span class="sd">                        The skew is plotted in the same subplot as the strike</span>
<span class="sd">                        angle at the moment</span>
<span class="sd">                        </span>
<span class="sd">                </span>
<span class="sd">        -period          period array cooresponding to the impedance tensor</span>
<span class="sd">        -font_size       size of font for the axis ticklabels, note that the </span>
<span class="sd">                         axis labels will be font_size+2</span>
<span class="sd">        </span>
<span class="sd">        -axr             matplotlib.axes object for the xy,yx resistivity plot.  </span>
<span class="sd">        -axp             matplotlib.axes object for the xy,yx phase plot</span>
<span class="sd">        -axt             matplotlib.axes object for the tipper plot</span>
<span class="sd">        -ax2r            matplotlib.axes object for the xx,yy resistivity plot</span>
<span class="sd">        -ax2p            matplotlib.axes object for the xx,yy phase plot</span>
<span class="sd">        -axs             matplotlib.axes object for the strike plot</span>
<span class="sd">        -axs2            matplotlib.axes object for the skew plot       </span>
<span class="sd">        ..</span>
<span class="sd">        </span>
<span class="sd">             **Note:** that from these axes object you have control of the</span>
<span class="sd">             plot.  You can do this by changing any parameter in the </span>
<span class="sd">             axes object and then calling update_plot()</span>
<span class="sd">        </span>
<span class="sd">        -erxyr          class matplotlib.container.ErrorbarContainer for </span>
<span class="sd">                        xy apparent resistivity.</span>
<span class="sd">        -erxyp          class matplotlib.container.ErrorbarContainer for </span>
<span class="sd">                        xy.</span>
<span class="sd">        -eryxr          class matplotlib.container.ErrorbarContainer for </span>
<span class="sd">                        yx apparent resistivity.</span>
<span class="sd">        -eryxp          class matplotlib.container.ErrorbarContainer for </span>
<span class="sd">                        yx phase.</span>
<span class="sd">        </span>
<span class="sd">        ..</span>
<span class="sd">        </span>
<span class="sd">            **Note:** that from these line objects you can manipulate the </span>
<span class="sd">            error bar properties and then call update_plot()</span>
<span class="sd">                     </span>
<span class="sd">        -xy_ls           line style for xy and xx components, *default* is None       </span>
<span class="sd">        -yx_ls           line style for yx and yy components, *default* is None        </span>
<span class="sd">        -det_ls          line style for determinant, *default* is None</span>
<span class="sd">        </span>
<span class="sd">        -xy_marker       marker for xy and xx, *default* is squares</span>
<span class="sd">        -yx_marker       marker for yx and yy, *default* is circles</span>
<span class="sd">        -det_marker      marker for determinant, *default* is diamonds</span>
<span class="sd">        </span>
<span class="sd">        -xy_color        marker color for xy and xx, *default* is blue</span>
<span class="sd">        -yx_color        marker color for yx and yy, *default* is red</span>
<span class="sd">        -det_color       marker color for determinant, *default* is green</span>
<span class="sd">        </span>
<span class="sd">        -xy_mfc          marker face color for xy and xx, *default* is None </span>
<span class="sd">        -yx_mfc          marker face color for yx and yy, *default* is None</span>
<span class="sd">        -det_mfc         marker face color for determinant, *default* is None</span>
<span class="sd">        </span>
<span class="sd">        -skew_marker     marker for skew angle, *default* is &#39;d&#39;</span>
<span class="sd">        -skew_color      color for skew angle, *default* is &#39;orange&#39;</span>
<span class="sd">        </span>
<span class="sd">        -strike_inv_marker  marker for strike angle determined by invariants</span>
<span class="sd">                            *default* is &#39;^&#39;</span>
<span class="sd">        -strike_inv_color   color for strike angle determined by invaraiants </span>
<span class="sd">                            *default* is (.2, .2, .7)</span>
<span class="sd">        -strike_pt_marker  marker for strike angle determined by pt, </span>
<span class="sd">                           *default* is&#39;v&#39;</span>
<span class="sd">        -strike_pt_color   color for strike angle determined by pt</span>
<span class="sd">                           *default* is (.7, .2, .2)</span>
<span class="sd">        </span>
<span class="sd">        -strike_tip_marker  marker for strike angle determined by tipper</span>
<span class="sd">                            *default* is &#39;&gt;&#39;</span>
<span class="sd">        -strike_tip_color   color for strike angle determined by tipper</span>
<span class="sd">                            *default* is (.2, .7, .2)</span>
<span class="sd">        </span>
<span class="sd">        -marker_size     size of marker in relative dimenstions, *default* is 2</span>
<span class="sd">        -marker_lw       line width of marker, *default* is 100./fig_dpi</span>
<span class="sd">        -lw              line width of line and errorbar lines</span>
<span class="sd">        ..</span>
<span class="sd">        </span>
<span class="sd">         *For more on line and marker styles see matplotlib.lines.Line2D*</span>
<span class="sd">        </span>
<span class="sd">        -arrow_lw          line width of the arrow, *default* is 0.75</span>
<span class="sd">        -arrow_head_width  head width of the arrow, *default* is 0 for no arrow</span>
<span class="sd">                           head.  Haven&#39;t found a good way to scale the arrow</span>
<span class="sd">                           heads in a log scale.</span>
<span class="sd">                         </span>
<span class="sd">        -arrow_head_length  head width of the arrow, *default* is 0 for no arrow</span>
<span class="sd">                            head.  Haven&#39;t found a good way to scale the arrow</span>
<span class="sd">                            heads in a log scale.</span>
<span class="sd">                          </span>
<span class="sd">        -arrow_color_real  color of the real arrows, *default* is black</span>
<span class="sd">        -arrow_color_imag  color of the imaginary arrows, *default* is blue</span>
<span class="sd">        </span>
<span class="sd">        -arrow_direction   0 for pointing towards a conductor and -1 for </span>
<span class="sd">                           pointing away from a conductor.</span>
<span class="sd">                          </span>

<span class="sd">        -x_limits        limits on the x-limits (period), *default* is None</span>
<span class="sd">                        which will estimate the min and max from the data, </span>
<span class="sd">                        setting the min as the floor(min(period)) and the max</span>
<span class="sd">                        as ceil(max(period)).  Input in linear scale if you</span>
<span class="sd">                        want to change the period limits, ie. (.1,1000)</span>
<span class="sd">                        </span>
<span class="sd">        -res_limits     limits on the resistivity, *default* is None, which </span>
<span class="sd">                        will estimate the min and max from the data, rounding</span>
<span class="sd">                        to the lowest and highest increments to the power of 10</span>
<span class="sd">                        Input in linear scale if you want to change them, </span>
<span class="sd">                        ie. (1,10000). Note this only sets the xy and yx </span>
<span class="sd">                        components, not the xx and yy.</span>
<span class="sd">                        </span>
<span class="sd">        -phase_limits   limits on the phase, *default* is (0,90) but will </span>
<span class="sd">                        adapt to the data if there is phase above 90 or below</span>
<span class="sd">                        0.  Input in degrees.  Note this only changes the xy</span>
<span class="sd">                        and yx components.</span>
<span class="sd">                        </span>
<span class="sd">        -phase_quadrant [ 1 | 3 ] </span>
<span class="sd">                        * 1 for both phases to be in 0 to 90, </span>
<span class="sd">                        * 3 for xy to be in 0-90 and yx to be in -180 to 270  </span>
<span class="sd">                        </span>
<span class="sd">        -tipper_limits  limits of the y-axis, *default* is (-1,1)</span>
<span class="sd">        </span>
<span class="sd">        -skew_limits    limits for skew angle, *default* is (-9,9)</span>
<span class="sd">        </span>
<span class="sd">        -strike_limits  limits for strike angle, *default* is (-90,90) </span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">    Methods:</span>
<span class="sd">    --------</span>
<span class="sd">        * *plot*: plots the pseudosection according to keywords</span>
<span class="sd">        * *redraw_plot*: redraws the plot, use if you change some of the </span>
<span class="sd">                         attributes.</span>
<span class="sd">        * *update_plot*: updates the plot, use if you change some of the </span>
<span class="sd">                         axes attributes, figure needs to be open to update.</span>
<span class="sd">        * *save_plot*: saves the plot to given filepath.</span>
<span class="sd">        </span>

<span class="sd">    &quot;&quot;&quot;</span>   
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PlotResponse</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="n">fn</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fn&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">z_object</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;z_object&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">tipper_object</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;tipper_object&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">mt_object</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;mt_object&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1">#--&gt; initialize an MTplot object</span>
        <span class="k">if</span> <span class="n">mt_object</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mt</span> <span class="o">=</span> <span class="n">mtpl</span><span class="o">.</span><span class="n">MTplot</span><span class="p">(</span><span class="n">fn</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span> 
                                   <span class="n">z_object</span><span class="o">=</span><span class="n">z_object</span><span class="p">,</span>
                                   <span class="n">tipper_object</span><span class="o">=</span><span class="n">tipper_object</span><span class="p">)</span>
                              
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mt</span> <span class="o">=</span> <span class="n">mt_object</span> 
            
        <span class="bp">self</span><span class="o">.</span><span class="n">phase_quadrant</span> <span class="o">=</span>  <span class="mi">1</span>
        
        <span class="c1">#mtpl.PlotSettings.__init__(self)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_num&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotation_angle</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;rotation_angle&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        
        <span class="c1">#set plot tipper or not</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tipper</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_tipper&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">)</span>
        
        <span class="c1">#plot strike angle or not</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_strike&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">)</span>
        
        <span class="c1">#plot skew angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_skew</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_skew&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">)</span>
        
        <span class="c1">#plot phase tensor ellipses</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_pt</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_pt&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">)</span>
        
        <span class="c1">#order of plots</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_order</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_order&#39;</span><span class="p">,</span> 
                                     <span class="p">[</span><span class="s1">&#39;tip&#39;</span> <span class="p">,</span> <span class="s1">&#39;pt&#39;</span><span class="p">,</span> <span class="s1">&#39;strike&#39;</span><span class="p">,</span> <span class="s1">&#39;skew&#39;</span><span class="p">])</span>
                                     
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">kk</span><span class="p">,</span> <span class="n">vv</span><span class="p">)</span> <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;tip&#39;</span> <span class="p">,</span> <span class="s1">&#39;pt&#39;</span><span class="p">,</span> 
                                                           <span class="s1">&#39;strike&#39;</span><span class="p">,</span> <span class="s1">&#39;skew&#39;</span><span class="p">],</span>
                                                           <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot_tipper</span><span class="p">,</span> 
                                                            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_pt</span><span class="p">,</span>
                                                            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span><span class="p">,</span> 
                                                            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_skew</span><span class="p">])])</span>
        
        <span class="c1">#set arrow properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arrow_head_length</span> <span class="o">=</span> <span class="mf">0.03</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arrow_head_width</span> <span class="o">=</span> <span class="mf">0.03</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arrow_lw</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
        
        <span class="c1">#ellipse_properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_size</span> <span class="o">=</span> <span class="mf">0.25</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_spacing</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ellipse_spacing&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_size</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_spacing</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_size</span> <span class="o">=</span> <span class="mf">0.25</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_yn</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_yn&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            
        <span class="c1">#plot on initializing</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_yn</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<div class="viewcode-block" id="PlotResponse.plot"><a class="viewcode-back" href="../../../imaging.html#mtpy.imaging.plotresponse.PlotResponse.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        plotResPhase(filename,fig_num) will plot the apparent resistivity and </span>
<span class="sd">        phase for a single station. </span>
<span class="sd"> </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1">#set figure size according to what the plot will be.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
            
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
            
        <span class="c1">#--&gt; rotate the impedance tensor if desired</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation_angle</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">rotation_angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation_angle</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tipper</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span><span class="o">.</span><span class="n">tipper</span> <span class="o">==</span> <span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">):</span>
                <span class="nb">print</span> <span class="s1">&#39;No Tipper data for station </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">station</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_tipper</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span>
        
        <span class="c1">#set x-axis limits from short period to long period</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">[</span><span class="mi">0</span><span class="p">]))),</span>
                            <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])))))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">pass</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">res_limits</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">res_limits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span>
                                    <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_xy</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_yx</span><span class="o">.</span><span class="n">min</span><span class="p">()])))),</span>
                              <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
                                    <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_xy</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_yx</span><span class="o">.</span><span class="n">max</span><span class="p">()])))))</span>

        <span class="c1">#set some parameters of the figure and subplot spacing</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.bottom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">1</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.top&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">93</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.left&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">80</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.right&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">98</span>
        
        <span class="c1">#set the font properties for the axis labels</span>
        <span class="n">fontdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="s1">&#39;bold&#39;</span><span class="p">}</span>
        
        <span class="c1">#create a dictionary for the number of subplots needed</span>
        <span class="n">pdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;res&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> 
                 <span class="s1">&#39;phase&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="c1">#start the index at 2 because resistivity and phase is permanent for </span>
        <span class="c1">#now </span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_order</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">pdict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">index</span>
                <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="c1">#get number of rows needed</span>
        <span class="n">nrows</span> <span class="o">=</span> <span class="n">index</span>
        
        <span class="c1">#set height ratios of the subplots</span>
        <span class="n">hr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pdict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
        
        <span class="c1">#create a grid to place the figures into, set to have 2 rows and 2 </span>
        <span class="c1">#columns to put any of the 4 components.  Make the phase plot</span>
        <span class="c1">#slightly shorter than the apparent resistivity plot and have the two</span>
        <span class="c1">#close to eachother vertically.  If there is tipper add a 3rd row and</span>
        <span class="c1">#if there is strike add another row</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="n">hr</span><span class="p">,</span><span class="n">hspace</span><span class="o">=.</span><span class="mi">05</span><span class="p">)</span>

        <span class="c1">#make figure instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_num</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">)</span>
        
        <span class="c1">#--&gt; make figure for xy,yx components</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="c1">#set label coordinates</span>
            <span class="n">labelcoords</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.075</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
            
            <span class="c1">#space out the subplots</span>
            <span class="n">gs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">hspace</span><span class="o">=.</span><span class="mi">05</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=.</span><span class="mi">15</span><span class="p">,</span> <span class="n">left</span><span class="o">=.</span><span class="mi">1</span><span class="p">)</span>
            
            <span class="c1">#--&gt; create the axes instances</span>
            <span class="c1">#apparent resistivity axis</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
                
            <span class="c1">#phase axis that shares period axis with resistivity</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axr</span><span class="p">)</span>
            

        
        <span class="c1">#--&gt; make figure for all 4 components</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1">#set label coordinates</span>
            <span class="n">labelcoords</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.095</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>            
            
            <span class="c1">#space out the subplots</span>
            <span class="n">gs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">hspace</span><span class="o">=.</span><span class="mi">05</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=.</span><span class="mi">15</span><span class="p">,</span> <span class="n">left</span><span class="o">=.</span><span class="mi">07</span><span class="p">)</span>
            
            <span class="c1">#--&gt; create the axes instances</span>
            <span class="c1">#apparent resistivity axis</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
            
            <span class="c1">#phase axis that shares period axis with resistivity</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axr</span><span class="p">)</span>
        
        <span class="c1">#place y coordinate labels in the same location                </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axr</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="n">labelcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labelcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axp</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="n">labelcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labelcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="c1">#--&gt; plot tipper</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;tip&#39;</span><span class="p">],</span> <span class="p">:],</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="n">labelcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labelcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
        
        <span class="c1">#--&gt; plot phase tensors</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1">#can&#39;t share axis because not on the same scale</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;pt&#39;</span><span class="p">],</span> <span class="p">:],</span> 
                                             <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="n">labelcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labelcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
        
        <span class="c1">#--&gt; plot strike</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;strike&#39;</span><span class="p">],</span> <span class="p">:],</span> 
                                             <span class="n">sharex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="n">labelcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labelcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
        
        <span class="c1">#--&gt; plot skew</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;skew&#39;</span><span class="p">],</span> <span class="p">:],</span> 
                                             <span class="n">sharex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="n">labelcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labelcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
    
        
        <span class="c1">#---------plot the apparent resistivity--------------------------------</span>
        <span class="c1">#--&gt; plot as error bars and just as points xy, yx</span>
        <span class="c1">#res_xy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ebxyr</span> <span class="o">=</span> <span class="n">mtpl</span><span class="o">.</span><span class="n">plot_errorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axr</span><span class="p">,</span> 
                                       <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span> 
                                       <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_xy</span><span class="p">,</span> 
                                       <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_marker</span><span class="p">,</span> 
                                       <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                       <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy_color</span><span class="p">,</span> 
                                       <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_ls</span><span class="p">,</span>
                                       <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">,</span>
                                       <span class="n">y_error</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_err_xy</span><span class="p">,</span> 
                                       <span class="n">e_capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">)</span>
        
        <span class="c1">#res_yx                              </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ebyxr</span> <span class="o">=</span> <span class="n">mtpl</span><span class="o">.</span><span class="n">plot_errorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axr</span><span class="p">,</span> 
                                       <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span> 
                                       <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_yx</span><span class="p">,</span> 
                                       <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_marker</span><span class="p">,</span> 
                                       <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span> 
                                       <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_color</span><span class="p">,</span> 
                                       <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_ls</span><span class="p">,</span>
                                       <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">,</span> 
                                       <span class="n">y_error</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_err_yx</span><span class="p">,</span> 
                                       <span class="n">e_capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">)</span>
                                      
        <span class="c1">#--&gt; set axes properties</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axr</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axr</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;App. Res. ($\mathbf{\Omega \cdot m}$)&#39;</span><span class="p">,</span>
                            <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axr</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axr</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axr</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axr</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">res_limits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axr</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                      <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axr</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">ebxyr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ebyxr</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> 
                        <span class="p">(</span><span class="s1">&#39;$Z_</span><span class="si">{xy}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$Z_</span><span class="si">{yx}</span><span class="s1">$&#39;</span><span class="p">),</span>
                        <span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
                        <span class="n">markerscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                        <span class="n">borderaxespad</span><span class="o">=.</span><span class="mi">01</span><span class="p">,</span>
                        <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">07</span><span class="p">,</span> 
                        <span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> 
                        <span class="n">borderpad</span><span class="o">=.</span><span class="mi">02</span><span class="p">)</span>
        
        <span class="c1">#-----Plot the phase---------------------------------------------------</span>
        <span class="c1">#phase_xy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ebxyp</span> <span class="o">=</span> <span class="n">mtpl</span><span class="o">.</span><span class="n">plot_errorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axp</span><span class="p">,</span> 
                                       <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span> 
                                       <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_xy</span><span class="p">,</span> 
                                       <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_marker</span><span class="p">,</span> 
                                       <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span> 
                                       <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_color</span><span class="p">,</span> 
                                       <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_ls</span><span class="p">,</span>
                                       <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">,</span>
                                       <span class="n">y_error</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_err_xy</span><span class="p">,</span> 
                                       <span class="n">e_capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">)</span>
                                      
        <span class="c1">#phase_yx: Note add 180 to place it in same quadrant as phase_xy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ebyxp</span> <span class="o">=</span> <span class="n">mtpl</span><span class="o">.</span><span class="n">plot_errorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axp</span><span class="p">,</span> 
                                       <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span> 
                                       <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_yx</span><span class="o">+</span><span class="mi">180</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">phase_quadrant</span><span class="p">,</span> 
                                       <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_marker</span><span class="p">,</span> 
                                       <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>  
                                       <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_color</span><span class="p">,</span> 
                                       <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_ls</span><span class="p">,</span> 
                                       <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">,</span>
                                       <span class="n">y_error</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_err_yx</span><span class="p">,</span> 
                                       <span class="n">e_capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">)</span>

        <span class="c1">#check the phase to see if any point are outside of [0:90]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_xy</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">or</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_yx</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">pymin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_xy</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_yx</span><span class="p">)])</span>
                <span class="k">if</span> <span class="n">pymin</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                   <span class="n">pymin</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pymin</span> <span class="o">=</span> <span class="mi">0</span>
            
            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_xy</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">90</span> <span class="ow">or</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_yx</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">90</span><span class="p">:</span>
                <span class="n">pymax</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_xy</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_yx</span><span class="p">)])</span>
                <span class="k">if</span> <span class="n">pymax</span> <span class="o">&lt;</span> <span class="mi">91</span><span class="p">:</span>
                    <span class="n">pymax</span> <span class="o">=</span> <span class="mf">89.9</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pymax</span> <span class="o">=</span> <span class="mf">89.9</span>
                
            <span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span> <span class="o">=</span> <span class="p">(</span><span class="n">pymin</span><span class="p">,</span> <span class="n">pymax</span><span class="p">)</span>
        
        <span class="c1">#--&gt; set axes properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axp</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period (s)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axp</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase (deg)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axp</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axp</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span><span class="p">)</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">axp</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axp</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axp</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                      <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>
        <span class="c1">#set th xaxis tick labels to invisible</span>
        <span class="k">if</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;phase&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axp</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axp</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            
        <span class="c1">#-----plot tipper----------------------------------------------------              </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tipper</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">txr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span><span class="o">.</span><span class="n">mag_real</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span><span class="o">.</span><span class="n">angle_real</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="o">+</span>\
                                     <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_direction</span><span class="p">)</span>
            <span class="n">tyr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span><span class="o">.</span><span class="n">mag_real</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span><span class="o">.</span><span class="n">angle_real</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="o">+</span>\
                                     <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_direction</span><span class="p">)</span>
    
            <span class="n">txi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span><span class="o">.</span><span class="n">mag_imag</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span><span class="o">.</span><span class="n">angle_imag</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="o">+</span>\
                                     <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_direction</span><span class="p">)</span>
            <span class="n">tyi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span><span class="o">.</span><span class="n">mag_imag</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span><span class="o">.</span><span class="n">angle_imag</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="o">+</span>\
                                     <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_direction</span><span class="p">)</span>
            
            <span class="n">nt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">txr</span><span class="p">)</span>
            
            <span class="n">tiplist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">tiplabel</span> <span class="o">=</span> <span class="p">[]</span>
            
            <span class="k">for</span> <span class="n">aa</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">txr</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MaskedArray</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">txr</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">aa</span><span class="p">]:</span>
                        <span class="k">continue</span>
                <span class="n">xlenr</span> <span class="o">=</span> <span class="n">txr</span><span class="p">[</span><span class="n">aa</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">[</span><span class="n">aa</span><span class="p">])</span>
                <span class="n">xleni</span> <span class="o">=</span> <span class="n">txi</span><span class="p">[</span><span class="n">aa</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">[</span><span class="n">aa</span><span class="p">])</span>
                
                <span class="c1">#--&gt; plot real arrows</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tipper</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">[</span><span class="n">aa</span><span class="p">]),</span>
                                   <span class="mi">0</span><span class="p">,</span>
                                   <span class="n">xlenr</span><span class="p">,</span>
                                   <span class="n">tyr</span><span class="p">[</span><span class="n">aa</span><span class="p">],</span>
                                   <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_lw</span><span class="p">,</span>
                                   <span class="n">facecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_color_real</span><span class="p">,</span>
                                   <span class="n">edgecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_color_real</span><span class="p">,</span>
                                   <span class="n">head_width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_head_width</span><span class="p">,</span>
                                   <span class="n">head_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_head_length</span><span class="p">,</span>
                                   <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="n">aa</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">line1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_color_real</span><span class="p">)</span>
                        <span class="n">tiplist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">tiplabel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
                                   
                <span class="c1">#--&gt; plot imaginary arrows</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tipper</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>               
                    <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">[</span><span class="n">aa</span><span class="p">]),</span>
                                   <span class="mi">0</span><span class="p">,</span>
                                   <span class="n">xleni</span><span class="p">,</span>
                                   <span class="n">tyi</span><span class="p">[</span><span class="n">aa</span><span class="p">],</span>
                                   <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_lw</span><span class="p">,</span>
                                   <span class="n">facecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_color_imag</span><span class="p">,</span>
                                   <span class="n">edgecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_color_imag</span><span class="p">,</span>
                                   <span class="n">head_width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_head_width</span><span class="p">,</span>
                                   <span class="n">head_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_head_length</span><span class="p">,</span>
                                   <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">aa</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>              
                        <span class="n">line2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_color_imag</span><span class="p">)</span>
                        <span class="n">tiplist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">tiplabel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;imag&#39;</span><span class="p">)</span>
                
            <span class="c1">#make a line at 0 for reference</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">nt</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
        
            
            <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">tiplist</span><span class="p">,</span> <span class="n">tiplabel</span><span class="p">,</span>
                            <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span>
                            <span class="n">markerscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">borderaxespad</span><span class="o">=.</span><span class="mi">01</span><span class="p">,</span>
                            <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">07</span><span class="p">,</span>
                            <span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">borderpad</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">})</span>

            <span class="c1">#set axis properties  </span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                               <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                               
            <span class="n">tklabels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">xticks</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">tk</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">tklabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mtpl</span><span class="o">.</span><span class="n">labeldict</span><span class="p">[</span><span class="n">tk</span><span class="p">])</span>
                    <span class="n">xticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tk</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">tklabels</span><span class="p">,</span> 
                                      <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period (s)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
            <span class="c1">#need to reset the x_limits caouse they get reset when calling</span>
            <span class="c1">#set_ticks for some reason</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                               <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                               
            <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="o">.</span><span class="mi">2</span><span class="p">))</span>               
            <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">))</span>               
            <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period (s)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Tipper&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>    
            
            <span class="c1">#self.axt.set_xscale(&#39;log&#39;)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tipper_limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">tmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">tyr</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">tyi</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="k">if</span> <span class="n">tmax</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">tmax</span> <span class="o">=</span> <span class="o">.</span><span class="mi">899</span>
                            
                <span class="n">tmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">tyr</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">tyi</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span>
                <span class="k">if</span> <span class="n">tmin</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">tmin</span> <span class="o">=</span> <span class="o">-.</span><span class="mi">899</span>
                            
                <span class="bp">self</span><span class="o">.</span><span class="n">tipper_limits</span> <span class="o">=</span> <span class="p">(</span><span class="n">tmin</span><span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="n">tmax</span><span class="o">+.</span><span class="mi">1</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tipper_limits</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                          <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>
            
            <span class="c1">#set th xaxis tick labels to invisible</span>
            <span class="k">if</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;tip&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="c1">#------plot strike angles----------------------------------------------</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">stlist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">stlabel</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">st_maxlist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">st_minlist</span> <span class="o">=</span> <span class="p">[]</span>
            
<span class="c1">#            if self._plot_strike.find(&#39;i&#39;) &gt; 0:</span>
<span class="c1">#                #strike from invariants</span>
<span class="c1">#                zinv = self.mt.get_Zinvariants()</span>
<span class="c1">#                s1 = zinv.strike</span>
<span class="c1">#                </span>
<span class="c1">#                #fold angles so go from -90 to 90</span>
<span class="c1">#                s1[np.where(s1&gt;90)] -= -180</span>
<span class="c1">#                s1[np.where(s1&lt;-90)] += 180</span>
<span class="c1">#                </span>
<span class="c1">#                #plot strike with error bars</span>
<span class="c1">#                ps1 = mtpl.plot_errorbar(self.axst,</span>
<span class="c1">#                                         self.mt.period, </span>
<span class="c1">#                                        s1, </span>
<span class="c1">#                                        marker=self.strike_inv_marker, </span>
<span class="c1">#                                        ms=self.marker_size,  </span>
<span class="c1">#                                        color=self.strike_inv_color, </span>
<span class="c1">#                                        ls=&#39;none&#39;,</span>
<span class="c1">#                                        lw=self.lw, </span>
<span class="c1">#                                        y_error=zinv.strike_err, </span>
<span class="c1">#                                        e_capsize=self.marker_size)</span>
<span class="c1">#                                        </span>
<span class="c1">#                stlist.append(ps1[0])</span>
<span class="c1">#                stlabel.append(&#39;Z_inv&#39;)</span>
<span class="c1">#                st_maxlist.append(s1.max())</span>
<span class="c1">#                st_minlist.append(s1.min())</span>
                                        
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                
                <span class="c1">#strike from phase tensor</span>
                <span class="n">s2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">azimuth</span>
                <span class="n">s2_err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">azimuth_err</span>
                <span class="c1">#fold angles to go from -90 to 90</span>
                <span class="n">s2</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s2</span><span class="o">&gt;</span><span class="mi">90</span><span class="p">)]</span> <span class="o">-=</span> <span class="mi">180</span>
                <span class="n">s2</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s2</span><span class="o">&lt;-</span><span class="mi">90</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">180</span>
                
                <span class="c1">#plot strike with error bars</span>
                <span class="n">ps2</span> <span class="o">=</span> <span class="n">mtpl</span><span class="o">.</span><span class="n">plot_errorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="p">,</span> 
                                         <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span> 
                                         <span class="n">s2</span><span class="p">,</span> 
                                         <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strike_pt_marker</span><span class="p">,</span> 
                                         <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span> 
                                         <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strike_pt_color</span><span class="p">,</span> 
                                         <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                                         <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">,</span> 
                                         <span class="n">y_error</span><span class="o">=</span><span class="n">s2_err</span><span class="p">,</span> 
                                         <span class="n">e_capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">)</span>
                                        
                <span class="n">stlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ps2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">stlabel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;PT&#39;</span><span class="p">)</span>
                <span class="n">st_maxlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s2</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
                <span class="n">st_minlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s2</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1">#strike from tipper</span>
                <span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span><span class="o">.</span><span class="n">angle_real</span><span class="o">+</span><span class="mi">90</span>
                
                <span class="c1">#fold to go from -90 to 90</span>
                <span class="n">s3</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s3</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">)]</span> <span class="o">-=</span> <span class="mi">180</span>
                <span class="n">s3</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s3</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">180</span>
                
                <span class="c1">#plot strike with error bars</span>
                <span class="n">ps3</span> <span class="o">=</span> <span class="n">mtpl</span><span class="o">.</span><span class="n">plot_errorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span> 
                                        <span class="n">s3</span><span class="p">,</span> 
                                        <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strike_tip_marker</span><span class="p">,</span> 
                                        <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>  
                                        <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strike_tip_color</span><span class="p">,</span> 
                                        <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> 
                                        <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">,</span>
                                        <span class="n">y_error</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                                        <span class="n">e_capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">)</span>
                                        
                <span class="n">stlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ps3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">stlabel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Tip&#39;</span><span class="p">)</span>
                <span class="n">st_maxlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s3</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
                <span class="n">st_minlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s3</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
                
            <span class="c1">#--&gt; set axes properties</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strike_limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">stmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">st_minlist</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="n">stmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">89.99</span>
                <span class="k">if</span> <span class="n">stmin</span><span class="o">-</span><span class="mi">3</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span><span class="p">:</span>
                    <span class="n">stmin</span> <span class="o">-=</span> <span class="mi">3</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">stmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">89.99</span>
                
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">stmax</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">st_maxlist</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="n">stmax</span> <span class="o">=</span> <span class="mf">89.99</span>    
                <span class="k">if</span> <span class="n">stmax</span><span class="o">+</span><span class="mi">3</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">:</span>
                    <span class="n">stmax</span> <span class="o">+=</span> <span class="mi">3</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">stmax</span> <span class="o">=</span> <span class="mf">89.99</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">strike_limits</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="nb">max</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">stmin</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">stmax</span><span class="p">)]),</span>
                                       <span class="nb">max</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">stmin</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">stmax</span><span class="p">)]))</span>
                                        
                
            <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axr</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Strike&#39;</span><span class="p">,</span>
                                <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period (s)&#39;</span><span class="p">,</span>
                                <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strike_limits</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                          <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">stlist</span><span class="p">,</span> 
                                 <span class="n">stlabel</span><span class="p">,</span>
                                 <span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
                                 <span class="n">markerscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                 <span class="n">borderaxespad</span><span class="o">=.</span><span class="mi">01</span><span class="p">,</span>
                                 <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">07</span><span class="p">,</span> 
                                 <span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> 
                                 <span class="n">borderpad</span><span class="o">=.</span><span class="mi">02</span><span class="p">,</span>
                                 <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="o">-</span><span class="mi">1</span><span class="p">})</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            
            <span class="c1">#set th xaxis tick labels to invisible</span>
            <span class="k">if</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;strike&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            
        <span class="c1">#------plot skew angle---------------------------------------------</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_skew</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
            <span class="c1">#strike from phase tensor</span>
            <span class="n">sk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">beta</span>
            <span class="n">sk_err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">beta_err</span>
            
            <span class="n">ps4</span> <span class="o">=</span> <span class="n">mtpl</span><span class="o">.</span><span class="n">plot_errorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="p">,</span> 
                                     <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span> 
                                    <span class="n">sk</span><span class="p">,</span> 
                                    <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">skew_marker</span><span class="p">,</span> 
                                    <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>  
                                    <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">skew_color</span><span class="p">,</span> 
                                    <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                                    <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">,</span> 
                                    <span class="n">y_error</span><span class="o">=</span><span class="n">sk_err</span><span class="p">,</span> 
                                    <span class="n">e_capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">)</span>
                                    
            <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">),</span> <span class="s1">&#39;-k&#39;</span><span class="p">,</span>
                           <span class="n">lw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">),</span> <span class="s1">&#39;-k&#39;</span><span class="p">,</span>
                           <span class="n">lw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">)</span>
                                    
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skew_limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">skew_limits</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skew_limits</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Skew&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period (s)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
           
            <span class="c1">#set th xaxis tick labels to invisible</span>
            <span class="k">if</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;skew&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="c1">#----plot phase tensor ellipse---------------------------------------    </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_pt</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>        
            
            <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_cmap</span>
            <span class="n">ckmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ckmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ckstep</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipse_range</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="n">ckstep</span> <span class="o">=</span> <span class="mi">3</span>
                
            <span class="k">if</span> <span class="n">cmap</span> <span class="o">==</span> <span class="s1">&#39;mt_seg_bl2wh2rd&#39;</span><span class="p">:</span>
                <span class="n">bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ckmin</span><span class="p">,</span> <span class="n">ckmax</span><span class="o">+</span><span class="n">ckstep</span><span class="p">,</span> <span class="n">ckstep</span><span class="p">)</span>
                <span class="n">nseg</span> <span class="o">=</span> <span class="nb">float</span><span class="p">((</span><span class="n">ckmax</span><span class="o">-</span><span class="n">ckmin</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">ckstep</span><span class="p">))</span>
    
            <span class="c1">#get the properties to color the ellipses by</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">==</span> <span class="s1">&#39;phiminang&#39;</span> <span class="ow">or</span> \
               <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">==</span> <span class="s1">&#39;phimin&#39;</span><span class="p">:</span>
                <span class="n">colorarray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">phimin</span>
                
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">==</span> <span class="s1">&#39;phimaxang&#39;</span> <span class="ow">or</span> \
               <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">==</span> <span class="s1">&#39;phimax&#39;</span><span class="p">:</span>
                <span class="n">colorarray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">phimax</span>
        
                                               
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">==</span> <span class="s1">&#39;phidet&#39;</span><span class="p">:</span>
                <span class="n">colorarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">det</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
                 
                
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">==</span> <span class="s1">&#39;skew&#39;</span> <span class="ow">or</span>\
                 <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">==</span> <span class="s1">&#39;skew_seg&#39;</span><span class="p">:</span>
                <span class="n">colorarray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">beta</span>
                
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">==</span> <span class="s1">&#39;ellipticity&#39;</span><span class="p">:</span>
                <span class="n">colorarray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">ellipticity</span>
                
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span><span class="o">+</span><span class="s1">&#39; is not supported&#39;</span><span class="p">)</span>
         
            <span class="c1">#-------------plot ellipses-----------------------------------</span>
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">ff</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">):</span>
                <span class="c1">#make sure the ellipses will be visable</span>
                <span class="n">eheight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">phimin</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">phimax</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span>\
                                                            <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_size</span>
                <span class="n">ewidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">phimax</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">phimax</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span>\
                                                            <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_size</span>
            
                <span class="c1">#create an ellipse scaled by phimin and phimax and oriented </span>
                <span class="c1">#along the azimuth which is calculated as clockwise but needs </span>
                <span class="c1">#to be plotted counter-clockwise hence the negative sign.</span>
                <span class="n">ellipd</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Ellipse</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipse_spacing</span><span class="p">,</span>
                                          <span class="mi">0</span><span class="p">),</span>
                                         <span class="n">width</span><span class="o">=</span><span class="n">ewidth</span><span class="p">,</span>
                                         <span class="n">height</span><span class="o">=</span><span class="n">eheight</span><span class="p">,</span>
                                         <span class="n">angle</span><span class="o">=</span><span class="mi">90</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">azimuth</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
                                         
                <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">ellipd</span><span class="p">)</span>
                
            
                <span class="c1">#get ellipse color</span>
                <span class="k">if</span> <span class="n">cmap</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;seg&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ellipd</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">mtcl</span><span class="o">.</span><span class="n">get_plot_color</span><span class="p">(</span><span class="n">colorarray</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                         <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span><span class="p">,</span>
                                                         <span class="n">cmap</span><span class="p">,</span>
                                                         <span class="n">ckmin</span><span class="p">,</span>
                                                         <span class="n">ckmax</span><span class="p">,</span>
                                                         <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ellipd</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">mtcl</span><span class="o">.</span><span class="n">get_plot_color</span><span class="p">(</span><span class="n">colorarray</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                         <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span><span class="p">,</span>
                                                         <span class="n">cmap</span><span class="p">,</span>
                                                         <span class="n">ckmin</span><span class="p">,</span>
                                                         <span class="n">ckmax</span><span class="p">))</span>
                
        
            <span class="c1">#----set axes properties-----------------------------------------------</span>
            <span class="c1">#--&gt; set tick labels and limits</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                               <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            
            <span class="n">tklabels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">xticks</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">tk</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">tklabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mtpl</span><span class="o">.</span><span class="n">labeldict</span><span class="p">[</span><span class="n">tk</span><span class="p">])</span>
                    <span class="n">xticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tk</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">tklabels</span><span class="p">,</span> 
                                      <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period (s)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=-</span><span class="mf">1.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipse_size</span><span class="p">,</span> 
                               <span class="n">ymax</span><span class="o">=</span><span class="mf">1.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipse_size</span><span class="p">)</span>
            <span class="c1">#need to reset the x_limits caouse they get reset when calling</span>
            <span class="c1">#set_ticks for some reason</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                               <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> 
                         <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span> 
                         <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> 
                         <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span><span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                         <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>
            
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;pt&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                
            <span class="c1">#add colorbar for PT</span>
            <span class="n">axpos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
            <span class="n">cb_position</span> <span class="o">=</span> <span class="p">(</span><span class="n">axpos</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-.</span><span class="mi">0575</span><span class="p">,</span>
                           <span class="n">axpos</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+.</span><span class="mi">02</span><span class="p">,</span>
                           <span class="o">.</span><span class="mi">01</span><span class="p">,</span>
                           <span class="n">axpos</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*.</span><span class="mi">75</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cbax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">cb_position</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cmap</span> <span class="o">==</span> <span class="s1">&#39;mt_seg_bl2wh2rd&#39;</span><span class="p">:</span>
                <span class="c1">#make a color list</span>
                <span class="n">clist</span> <span class="o">=</span> <span class="p">[(</span><span class="n">cc</span><span class="p">,</span> <span class="n">cc</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> 
                        <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">nseg</span><span class="p">),</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">nseg</span><span class="p">))]</span><span class="o">+</span>\
                       <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="n">cc</span><span class="p">,</span> <span class="n">cc</span><span class="p">)</span> 
                        <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">nseg</span><span class="p">),</span><span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">nseg</span><span class="p">))]</span>
                
                <span class="c1">#make segmented colormap</span>
                <span class="n">mt_seg_bl2wh2rd</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span><span class="n">clist</span><span class="p">)</span>
    
                <span class="c1">#make bounds so that the middle is white</span>
                <span class="n">bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ckmin</span><span class="o">-</span><span class="n">ckstep</span><span class="p">,</span> <span class="n">ckmax</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">ckstep</span><span class="p">,</span> <span class="n">ckstep</span><span class="p">)</span>
                
                <span class="c1">#normalize the colors</span>
                <span class="n">norms</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">mt_seg_bl2wh2rd</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
                
                <span class="c1">#make the colorbar</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cbpt</span> <span class="o">=</span> <span class="n">mcb</span><span class="o">.</span><span class="n">ColorbarBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cbax</span><span class="p">,</span>
                                           <span class="n">cmap</span><span class="o">=</span><span class="n">mt_seg_bl2wh2rd</span><span class="p">,</span>
                                           <span class="n">norm</span><span class="o">=</span><span class="n">norms</span><span class="p">,</span>
                                           <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
                                           <span class="n">ticks</span><span class="o">=</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cbpt</span> <span class="o">=</span> <span class="n">mcb</span><span class="o">.</span><span class="n">ColorbarBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cbax</span><span class="p">,</span>
                                           <span class="n">cmap</span><span class="o">=</span><span class="n">mtcl</span><span class="o">.</span><span class="n">cmapdict</span><span class="p">[</span><span class="n">cmap</span><span class="p">],</span>
                                           <span class="n">norm</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">ckmin</span><span class="p">,</span>
                                                                 <span class="n">vmax</span><span class="o">=</span><span class="n">ckmax</span><span class="p">),</span>
                                            <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cbpt</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="n">ckmin</span><span class="p">,</span> <span class="p">(</span><span class="n">ckmax</span><span class="o">-</span><span class="n">ckmin</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">ckmax</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cbpt</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0:.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ckmin</span><span class="p">),</span>
                                      <span class="s1">&#39;</span><span class="si">{0:.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="n">ckmax</span><span class="o">-</span><span class="n">ckmin</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
                                      <span class="s1">&#39;</span><span class="si">{0:.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ckmax</span><span class="p">)])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cbpt</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cbpt</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="o">-</span><span class="mf">1.05</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cbpt</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cbpt</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cbpt</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">mtpl</span><span class="o">.</span><span class="n">ckdict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span><span class="p">],</span> 
                                <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">})</span>
                        
            
        <span class="c1">#===Plot the xx, yy components if desired==============================</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1">#---------plot the apparent resistivity----------------------------</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axr2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axr2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
            
            <span class="c1">#res_xx</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ebxxr</span> <span class="o">=</span> <span class="n">mtpl</span><span class="o">.</span><span class="n">plot_errorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axr2</span><span class="p">,</span> 
                                            <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span> 
                                            <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_xx</span><span class="p">,</span> 
                                            <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_marker</span><span class="p">,</span> 
                                            <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span> 
                                            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_color</span><span class="p">,</span> 
                                            <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_ls</span><span class="p">,</span>
                                            <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">,</span> 
                                            <span class="n">y_error</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_err_xx</span><span class="p">,</span> 
                                            <span class="n">e_capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">)</span>
            
            <span class="c1">#res_yy                              </span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ebyyr</span> <span class="o">=</span> <span class="n">mtpl</span><span class="o">.</span><span class="n">plot_errorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axr2</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span> 
                                            <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_yy</span><span class="p">,</span> 
                                            <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_marker</span><span class="p">,</span> 
                                            <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>  
                                            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_color</span><span class="p">,</span>  
                                            <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_ls</span><span class="p">,</span>
                                            <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">,</span> 
                                            <span class="n">y_error</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_err_yy</span><span class="p">,</span> 
                                            <span class="n">e_capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">)</span>

            <span class="c1">#--&gt; set axes properties</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axr2</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axr2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axr2</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axr2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axr2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span> 
                           <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> 
                           <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                           <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>
                           
            <span class="bp">self</span><span class="o">.</span><span class="n">axr2</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">ebxxr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ebyyr</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> 
                            <span class="p">(</span><span class="s1">&#39;$Z_</span><span class="si">{xx}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="s1">&#39;$Z_</span><span class="si">{yy}</span><span class="s1">$&#39;</span><span class="p">),</span>
                            <span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">markerscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                            <span class="n">borderaxespad</span><span class="o">=.</span><span class="mi">01</span><span class="p">,</span>
                            <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">07</span><span class="p">,</span> 
                            <span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> 
                            <span class="n">borderpad</span><span class="o">=.</span><span class="mi">02</span><span class="p">)</span>
            
            <span class="c1">#-----Plot the phase-----------------------------------------------</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axp2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axr</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">axp2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
            
            <span class="c1">#phase_xx</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ebxxp</span> <span class="o">=</span> <span class="n">mtpl</span><span class="o">.</span><span class="n">plot_errorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axp2</span><span class="p">,</span> 
                                            <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span> 
                                            <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_xx</span><span class="p">,</span> 
                                            <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_marker</span><span class="p">,</span> 
                                            <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_color</span><span class="p">,</span>  
                                            <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_ls</span><span class="p">,</span>
                                            <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">,</span> 
                                            <span class="n">y_error</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_err_xx</span><span class="p">,</span>
                                            <span class="n">e_capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">)</span>
                                            
            <span class="c1">#phase_yy</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ebyyp</span> <span class="o">=</span> <span class="n">mtpl</span><span class="o">.</span><span class="n">plot_errorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axp2</span><span class="p">,</span> 
                                            <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_yy</span><span class="p">,</span> 
                                            <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_marker</span><span class="p">,</span>
                                            <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span> 
                                            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_color</span><span class="p">,</span> 
                                            <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_ls</span><span class="p">,</span>
                                            <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">,</span> 
                                            <span class="n">y_error</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_err_yy</span><span class="p">,</span> 
                                            <span class="n">e_capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">)</span>
            
            <span class="c1">#--&gt; set axes properties</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axp2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period (s)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axp2</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axp2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=-</span><span class="mf">179.9</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">179.9</span><span class="p">)</span>        
            <span class="bp">self</span><span class="o">.</span><span class="n">axp2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axp2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axp2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span> 
                           <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> 
                           <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                           <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span> 
                           
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pdict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axp2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axp2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_label</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="c1">#===Plot the Determinant if desired==================================                          </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                
            <span class="c1">#res_det</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ebdetr</span> <span class="o">=</span> <span class="n">mtpl</span><span class="o">.</span><span class="n">plot_errorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axr</span><span class="p">,</span> 
                                            <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span> 
                                            <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_det</span><span class="p">,</span> 
                                            <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">det_marker</span><span class="p">,</span> 
                                            <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span> 
                                            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">det_color</span><span class="p">,</span>  
                                            <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">det_ls</span><span class="p">,</span> 
                                            <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">,</span>
                                            <span class="n">y_error</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_det_err</span><span class="p">,</span> 
                                            <span class="n">e_capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">)</span>
        
            <span class="c1">#phase_det</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ebdetp</span> <span class="o">=</span> <span class="n">mtpl</span><span class="o">.</span><span class="n">plot_errorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axp</span><span class="p">,</span> 
                                            <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span> 
                                            <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_det</span><span class="p">,</span> 
                                            <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">det_marker</span><span class="p">,</span> 
                                            <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>  
                                            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">det_color</span><span class="p">,</span>  
                                            <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">det_ls</span><span class="p">,</span>
                                            <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">,</span> 
                                            <span class="n">y_error</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_det_err</span><span class="p">,</span> 
                                            <span class="n">e_capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">)</span>
                                            
            <span class="bp">self</span><span class="o">.</span><span class="n">axr</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">ebxyr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ebyxr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ebdetr</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                            <span class="p">(</span><span class="s1">&#39;$Z_</span><span class="si">{xy}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="s1">&#39;$Z_</span><span class="si">{yx}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="s1">&#39;$\det(\mathbf{\hat</span><span class="si">{Z}</span><span class="s1">})$&#39;</span><span class="p">),</span>
                            <span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                            <span class="n">markerscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">borderaxespad</span><span class="o">=.</span><span class="mi">01</span><span class="p">,</span>
                            <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">07</span><span class="p">,</span>
                            <span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">borderpad</span><span class="o">=.</span><span class="mi">02</span><span class="p">)</span>
        
        
        <span class="c1">#make plot_title and show</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">station</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_title</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
        
        <span class="c1"># be sure to show</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
        
    <span class="k">def</span> <span class="nf">_set_plot_tipper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_tipper</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If plotting tipper make arrow attributes</span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tipper</span> <span class="o">=</span> <span class="n">plot_tipper</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_dict</span><span class="p">[</span><span class="s1">&#39;tip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tipper</span>
        
    <span class="k">def</span> <span class="nf">_get_plot_tipper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tipper</span>
        
    <span class="n">plot_tipper</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="o">=</span><span class="n">_get_plot_tipper</span><span class="p">,</span> <span class="n">fset</span><span class="o">=</span><span class="n">_set_plot_tipper</span><span class="p">,</span> 
                           <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;string to plot tipper&quot;&quot;&quot;</span><span class="p">)</span>
                           
    <span class="k">def</span> <span class="nf">_set_plot_pt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_pt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If plotting tipper make arrow attributes</span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_pt</span> <span class="o">=</span> <span class="n">plot_pt</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_dict</span><span class="p">[</span><span class="s1">&#39;pt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_pt</span>
        
    <span class="k">def</span> <span class="nf">_get_plot_pt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_pt</span>
        
    <span class="n">plot_pt</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="o">=</span><span class="n">_get_plot_pt</span><span class="p">,</span> <span class="n">fset</span><span class="o">=</span><span class="n">_set_plot_pt</span><span class="p">,</span> 
                       <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;string to plot phase tensor ellipses&quot;&quot;&quot;</span><span class="p">)</span>
                       
    <span class="k">def</span> <span class="nf">_set_plot_strike</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_strike</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        change plot_dict when changing plot_strike</span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span> <span class="o">=</span> <span class="n">plot_strike</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_dict</span><span class="p">[</span><span class="s1">&#39;strike&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span>
    
    <span class="k">def</span> <span class="nf">_get_plot_strike</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>    
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span>
        
    <span class="n">plot_strike</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="o">=</span><span class="n">_get_plot_strike</span><span class="p">,</span> <span class="n">fset</span><span class="o">=</span><span class="n">_set_plot_strike</span><span class="p">,</span> 
                           <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;string to plot strike&quot;&quot;&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_set_plot_skew</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_skew</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        change plot_dict when changing plot_strike</span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_skew</span> <span class="o">=</span> <span class="n">plot_skew</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_dict</span><span class="p">[</span><span class="s1">&#39;skew&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_skew</span>
    
    <span class="k">def</span> <span class="nf">_get_plot_skew</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_skew</span>
        
    <span class="n">plot_skew</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="o">=</span><span class="n">_get_plot_skew</span><span class="p">,</span> <span class="n">fset</span><span class="o">=</span><span class="n">_set_plot_skew</span><span class="p">,</span> 
                           <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;string to plot skew&quot;&quot;&quot;</span><span class="p">)</span>
        

<div class="viewcode-block" id="PlotResponse.save_plot"><a class="viewcode-back" href="../../../imaging.html#mtpy.imaging.plotresponse.PlotResponse.save_plot">[docs]</a>    <span class="k">def</span> <span class="nf">save_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_fn</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;portrait&#39;</span><span class="p">,</span> 
                  <span class="n">fig_dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">close_plot</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        save_plot will save the figure to save_fn.</span>
<span class="sd">        </span>
<span class="sd">        Arguments:</span>
<span class="sd">        -----------</span>
<span class="sd">        </span>
<span class="sd">            **save_fn** : string</span>
<span class="sd">                          full path to save figure to, can be input as</span>
<span class="sd">                          * directory path -&gt; the directory path to save to</span>
<span class="sd">                            in which the file will be saved as </span>
<span class="sd">                            save_fn/station_name_ResPhase.file_format</span>
<span class="sd">                            </span>
<span class="sd">                          * full path -&gt; file will be save to the given </span>
<span class="sd">                            path.  If you use this option then the format</span>
<span class="sd">                            will be assumed to be provided by the path</span>
<span class="sd">                            </span>
<span class="sd">            **file_format** : [ pdf | eps | jpg | png | svg ]</span>
<span class="sd">                              file type of saved figure pdf,svg,eps... </span>
<span class="sd">                              </span>
<span class="sd">            **orientation** : [ landscape | portrait ]</span>
<span class="sd">                              orientation in which the file will be saved</span>
<span class="sd">                              *default* is portrait</span>
<span class="sd">                              </span>
<span class="sd">            **fig_fig_dpi** : int</span>
<span class="sd">                          The resolution in dots-per-inch the file will be</span>
<span class="sd">                          saved.  If None then the fig_dpi will be that at </span>
<span class="sd">                          which the figure was made.  I don&#39;t think that </span>
<span class="sd">                          it can be larger than fig_dpi of the figure.</span>
<span class="sd">                          </span>
<span class="sd">            **close_plot** : [ y | n ]</span>
<span class="sd">                             * &#39;y&#39; will close the plot after saving.</span>
<span class="sd">                             * &#39;n&#39; will leave plot open</span>
<span class="sd">                          </span>
<span class="sd">        :Example: ::</span>
<span class="sd">            </span>
<span class="sd">            &gt;&gt;&gt; # to save plot as jpg</span>
<span class="sd">            &gt;&gt;&gt; import mtpy.imaging.mtplottools as mtplot</span>
<span class="sd">            &gt;&gt;&gt; p1 = mtplot.PlotResPhase(r&#39;/home/MT/mt01.edi&#39;)</span>
<span class="sd">            &gt;&gt;&gt; p1.save_plot(r&#39;/home/MT/figures&#39;, file_format=&#39;jpg&#39;)</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">fig_dpi</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig_dpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span>
            
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">save_fn</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">file_format</span> <span class="o">=</span> <span class="n">save_fn</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_fn</span><span class="p">,</span> <span class="n">fig_dpi</span><span class="o">=</span><span class="n">fig_dpi</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">file_format</span><span class="p">,</span>
                             <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">save_fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_fn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="o">.</span><span class="n">station</span><span class="o">+</span><span class="s1">&#39;_ResPhase.&#39;</span><span class="o">+</span>
                                    <span class="n">file_format</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_fn</span><span class="p">,</span> <span class="n">fig_dpi</span><span class="o">=</span><span class="n">fig_dpi</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">file_format</span><span class="p">,</span>
                        <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">close_plot</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_fn</span> <span class="o">=</span> <span class="n">save_fn</span>
        <span class="nb">print</span> <span class="s1">&#39;Saved figure to: &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_fn</span></div>

<div class="viewcode-block" id="PlotResponse.update_plot"><a class="viewcode-back" href="../../../imaging.html#mtpy.imaging.plotresponse.PlotResponse.update_plot">[docs]</a>    <span class="k">def</span> <span class="nf">update_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        update any parameters that where changed using the built-in draw from</span>
<span class="sd">        canvas.  </span>
<span class="sd">        </span>
<span class="sd">        Use this if you change an of the .fig or axes properties</span>
<span class="sd">        </span>
<span class="sd">        :Example: ::</span>
<span class="sd">            </span>
<span class="sd">            &gt;&gt;&gt; # to change the grid lines to only be on the major ticks</span>
<span class="sd">            &gt;&gt;&gt; import mtpy.imaging.mtplottools as mtplot</span>
<span class="sd">            &gt;&gt;&gt; p1 = mtplot.PlotResPhase(r&#39;/home/MT/mt01.edi&#39;)</span>
<span class="sd">            &gt;&gt;&gt; [ax.grid(True, which=&#39;major&#39;) for ax in [p1.axr,p1.axp]]</span>
<span class="sd">            &gt;&gt;&gt; p1.update_plot()</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>
        
<div class="viewcode-block" id="PlotResponse.redraw_plot"><a class="viewcode-back" href="../../../imaging.html#mtpy.imaging.plotresponse.PlotResponse.redraw_plot">[docs]</a>    <span class="k">def</span> <span class="nf">redraw_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        use this function if you updated some attributes and want to re-plot.</span>
<span class="sd">        </span>
<span class="sd">        :Example: ::</span>
<span class="sd">            </span>
<span class="sd">            &gt;&gt;&gt; # change the color and marker of the xy components</span>
<span class="sd">            &gt;&gt;&gt; import mtpy.imaging.mtplottools as mtplot</span>
<span class="sd">            &gt;&gt;&gt; p1 = mtplot.PlotResPhase(r&#39;/home/MT/mt01.edi&#39;)</span>
<span class="sd">            &gt;&gt;&gt; p1.xy_color = (.5,.5,.9)</span>
<span class="sd">            &gt;&gt;&gt; p1.xy_marker = &#39;*&#39;</span>
<span class="sd">            &gt;&gt;&gt; p1.redraw_plot()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span></div>
        
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        rewrite the string builtin to give a useful message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">return</span> <span class="s2">&quot;Plots Resistivity and phase for the different modes of the&quot;</span> <span class="o">+</span>\
              <span class="s2">&quot;MT response.&quot;</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../master_doc.html">mtpy 1.01.01 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Geoscience Australia.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.2.
    </div>
  </body>
</html>